---
title: "Appendix 3a:" 
subtitle: "Deadly Mass Shootings (DMS) Analysis Results"
output:
  html_document: default
  word_document: default
  pdf_document: default
---

```{r setup, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
## load packages
require(readxl)
require(data.table)
require(tidyverse)
require(dplyr)
require(car)
require(lmtest)
require(sandwich)
require(psych)
require(tseries)
require(fUnitRoots)
require(urca)
require(TSA)
require(forecast)
require(ggplot2)
require(ggthemes)
require(corrplot)
require(sjPlot)
require(gridExtra)

```


```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# read in excel file
# Comprehensive Assessment of Deadly Mass Shootings 1980-2018
dms <- read_excel("/Data/Mass_film_8018_rates.xlsx")
```

### Section 1    
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# df set
# vars and correlation
dms_core <- dms[,c(1,10:12,61:64,67:69,54)]

#rename vars
dms_core <- dms_core %>%
  rename(`Single Act` = single_rate,
         `Multiple Acts` = multiple_rate,
         `Single Act w/G` = single_rate_gun,
         `Multiple Acts w/G` = multiple_rate_gun,
         `Mass Shootings` = incidents_per_yr,
         Fatalities = fatalities_per_yr,
         Injuries = injuries_per_yr,
         `Major US Military Involvement` = `Major military involvement`,
         `Mental Health Issues` = `Shooter mental health issues`,
         `FA Weapons Ban` = `FAWB (tighten)`)

# convert Mental Health Issues to binary outcome
dms_core$`Mental Health Issues` <- ifelse(dms_core$`Mental Health Issues` == "Yes", 1,0)

# aggregate and get means
# get average fatalities and injuries per shooting
dms_core <- aggregate(subset(dms_core, sel = -Year), list(year = dms_core$Year), mean, na.rm=T)
dms_core <- dms_core %>%
  rename(Year = year) %>%
  mutate(`Fatalities/Shootings` = Fatalities/`Mass Shootings`,
         `Injuries/Shootings` = Injuries/`Mass Shootings`)

# make into ts object
dms_cor_ts <- ts(dms_core)
```

### Descriptive Statistics

```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# correlations and visualizations
# descriptives
tab_df(describe(dms_cor_ts),
  title = "Deadly Mass Shootings",
  show.rownames = TRUE)
```

### Correlations
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# create a dms correlation matrix
dms_cor_matrix <- cor(dms_cor_ts, use = "complete.obs")
tab_corr(dms_cor_matrix)
```

### Visualizations

### Correlation Table
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# create a dms correlation plot
corrplot(dms_cor_matrix[c(1,5:11,13,14),c(1,5:11,13,14)], method = "number", number.cex = 0.7, tl.col = "black", tl.cex = 0.95, tl.offset = 0.4)
```

### Independent and Dependent Variable Time Trends   
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# dms objects for gg plot
# Single Act
dms_single <- dms_core %>%
  group_by(Year,`Single Act`) %>%
  distinct(.keep_all = FALSE) %>%
  summarise()

# Multiple Act
dms_multi <- dms_core %>%
  group_by(Year,`Multiple Acts`) %>%
  distinct(.keep_all = FALSE) %>%
  summarise()

# Single Act w/Gun
dms_single_gun <- dms_core %>%
  group_by(Year,`Single Act w/G`) %>%
  distinct(.keep_all = FALSE) %>%
  summarise()

# Multiple Act w/Gun
dms_multi_gun <- dms_core %>%
  group_by(Year,`Multiple Acts w/G`) %>%
  distinct(.keep_all = FALSE) %>%
  summarise()
```


```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# dms movie ggplots
# Single Act
dms_sing <- ggplot(data = dms_single, aes(x = Year, y = `Single Act`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Rates of Top Ten Movies with a Single Modeled Act \nof Violence Over Time",
       subtitle = "Modeled Act w/o Firearm",
       x = "Year",
       y = "Single Modeled Act of Violence (Rates)") +
  theme_tufte() +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.1)) +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))


# Multiple Act
dms_multi <- ggplot(data = dms_multi, aes(x = Year, y = `Multiple Acts`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Rates of Top Ten Movies with Multiple Modeled Acts \nof Violence Over Time",
       subtitle = "Modeled Acts w/o Firearms",
       x = "Year",
       y = "Multiple Modeled Acts of Violence (Rates)") +
  theme_tufte() +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.1)) +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Single Act w/Gun
dms_sing_gun <- ggplot(data = dms_single_gun, aes(x = Year, y = `Single Act w/G`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Rates of Top Ten Movies with a Single Modeled Act \nof Violence Over Time",
       subtitle = "Modeled Act w/ Firearm",
       x = "Year",
       y = "Single Modeled Acts of Violence (Rates)") +
  theme_tufte() +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.1)) +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Multiple Act w/Gun
dms_multi_gun <- ggplot(data = dms_multi_gun, aes(x = Year, y = `Multiple Acts w/G`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Rates of Top Ten Movies with Multiple Modeled Acts \nof Violence Over Time",
       subtitle = "Modeled Acts w/ At Least One Firearm Instance",
       x = "Year",
       y = "Multiple Modeled Acts of Violence (Rates)") +
  theme_tufte() +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.1)) +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))
```


```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# dms gun violence ggplots
# Mass Shootings
dms_incidents_per_yr <- ggplot(data = dms_core, aes(x = Year, y = `Mass Shootings`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Deadly Mass Shootings Over Time",
       x = "Year",
       y = "Number of Deadly Mass Shootings") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = min(dms_core$`Mass Shootings`),color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# fatalities during Mass Shootings
dms_fatalities_per_yr <- ggplot(data = dms_core, aes(x = Year, y = Fatalities)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Fatalities During Deadly Mass Shootings Over Time",
       x = "Year",
       y = "Number of Fatalities During Deadly Mass Shootings") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = min(dms_core$Fatalities),color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

#injuries during Mass Shootings
dms_injuries_per_yr <- ggplot(data = dms_core, aes(x = Year, y = Injuries)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Injuries During Deadly Mass Shootings Over Time",
       x = "Year",
       y = "Number of Injuries During Deadly Mass Shootings") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = min(dms_core$Injuries),color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Average fatalities per Mass Shootings
dms_fatalities_per_ms <- ggplot(data = dms_core, aes(x = Year, y = Fatalities/`Mass Shootings`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Average Fatalities per Deadly Mass Shooting Over Time",
       x = "Year",
       y = "Average Fatalities per Deadly Mass Shooting") +
  theme_tufte() +
   # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 4,color = "black", label = "Firearm Weapons Ban", size = 1.9) +
  theme(text = element_text(size = 9),
  axis.text = element_text(size = 8),
  axis.title = element_text(size = 8),
  legend.title = element_text(size = 9))

# Average injuries per Mass Shootings
dms_injuries_per_ms <- ggplot(data = dms_core, aes(x = Year, y = Injuries/`Mass Shootings`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Average Injuries per Deadly Mass Shooting Over Time",
       x = "Year",
       y = "Average Injuries per Deadly Mass Shootings") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0,color = "black", label = "Firearm Weapons Ban", size = 1.9) +
  theme(text = element_text(size = 9),
  axis.text = element_text(size = 8),
  axis.title = element_text(size = 8),
  legend.title = element_text(size = 9))
```


```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# dms gun violence LOG ggplots
# Mass Shootings (LOG)
dms_incidents_per_yr_log <- ggplot(data = dms_core, aes(x = Year, y = log(`Mass Shootings`))) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Deadly Mass Shootings Over Time (LOG)",
       x = "Year",
       y = "Number of Deadly Mass Shootings (LOG)") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = min(log(dms_core$`Mass Shootings`)),color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# fatalities during Mass Shootings (LOG)
dms_fatalities_per_yr_log <- ggplot(data = dms_core, aes(x = Year, y = log(Fatalities))) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Fatalities During Deadly Mass Shootings Over Time (LOG)",
       x = "Year",
       y = "Number of Fatalities During Deadly Mass Shootings (LOG)") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = min(log(dms_core$Fatalities)),color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

#injuries during Mass Shootings (LOG)
dms_injuries_per_yr_log <- ggplot(data = dms_core, aes(x = Year, y = log(Injuries))) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Injuries During Deadly Mass Shootings Over Time (LOG)",
       x = "Year",
       y = "Number of Injuries During Deadly Mass Shootings (LOG)") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = min(log(dms_core$Injuries)),color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Average fatalities per Mass Shootings LOG
dms_fatalities_per_ms_log <- ggplot(data = dms_core, aes(x = Year, y = log(Fatalities/`Mass Shootings`))) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Average Fatalities per Deadly Mass Shooting \nOver Time (LOG)",
       x = "Year",
       y = "Average Fatalities per Deadly Mass Shooting (LOG)") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = min(log(dms_core$Fatalities/dms_core$`Mass Shootings`)),color = "black", label = "Firearm Weapons Ban", size = 1.9) +
  theme(text = element_text(size = 9),
  axis.text = element_text(size = 8),
  axis.title = element_text(size = 8),
  legend.title = element_text(size = 9))

# Average injuries per Mass Shootings LOG
dms_injuries_per_ms_log <- ggplot(data = dms_core, aes(x = Year, y = log(Injuries/`Mass Shootings`)))+
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Average Injuries per Deadly Mass Shooting \nOver Time (LOG)",
       x = "Year",
       y = "Average Injuries per Deadly Mass Shooting (LOG)") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = min(log(dms_core$Injuries/dms_core$`Mass Shootings`)),color = "black", label = "Firearm Weapons Ban", size = 1.9) +
  theme(text = element_text(size = 9),
  axis.text = element_text(size = 8),
  axis.title = element_text(size = 8),
  legend.title = element_text(size = 9))
```

## 
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE, fig.width = 7.5}
# DMS
# visualization of ggplots (call gg objects)
# dms movie rates plots
# dms_sing
# dms_multi
# dms_sing_gun
# dms_multi_gun
grid.arrange(dms_sing,dms_multi,dms_sing_gun,dms_multi_gun)
```

## 
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE, fig.width = 7.5}
# dms yearly violence counts plots
# dms_incidents_per_yr
# dms_fatalities_per_yr
# dms_injuries_per_yr
# dms_fatalities_per_ms
# dms_injuries_per_ms

grid.arrange(dms_incidents_per_yr,dms_fatalities_per_yr,dms_injuries_per_yr, ncol=2)
grid.arrange(dms_fatalities_per_ms,dms_injuries_per_ms, ncol=2)

# dms yearly violence counts LOG plots
# dms_incidents_per_yr_log
# dms_fatalities_per_yr_log
# dms_injuries_per_yr_log
# dms_fatalities_per_ms_log
# dms_injuries_per_ms_log

grid.arrange(dms_incidents_per_yr_log,dms_fatalities_per_yr_log,dms_injuries_per_yr_log, ncol=2)
grid.arrange(dms_fatalities_per_ms_log,dms_injuries_per_ms_log, ncol=2)
```

### Section 2
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE, fig.width = 7.5}
```


### Test First regression for AR and UR   
Base linear model with prime variables of interest:    
*Multiple Acts w/G* (IV) and *Mass Shootings* (DV)  
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# new df for lm
dms_lm <- dms_core

# LM Regression
# perform a dms naive regression
dms_model <- lm(`Mass Shootings` ~ `Multiple Acts w/G` + Year, data = dms_lm)

# print the summary of the model
tab_model(dms_model)

```

### Test for autocorrelation in the errors  
em = residuals from the base linear model   
Lag <= 3   
Seems no AR is present  

```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# check for AR 
# residuals
em <- dms_model$resid
#min(em)
#max(em)
acf(em,xlim =c(0,40), col = "red", lwd =2)
pacf(em,xlim =c(0,40), col = "red", lwd =2)
plot(em)

# durbin-watson test auto* correlation seems NO AR present
dwt(dms_model, max.lag = 1)
durbinWatsonTest(dms_model, max.lag=1)

# breusch-Godfrey test serial* correlation  NO AR PRESENT
bgtest(dms_model)
```

### Test for unit roots  
Seems UR is present   
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
##### CHECK FOR UNIT ROOTS #### seems like there is UR
# Dickey-Fuller
# augmented Dickey-Fuller test
adfTest(dms_lm[,"Mass Shootings"], lags = 2)
adfTest(dms_lm[,"Mass Shootings"], lags = 3)
# augmented Dickey-Fuller w/ DRIFT
adfTest(dms_lm[,"Mass Shootings"], lags = 2,type="c")
# augmented Dickey-Fuller w/ TREND
adfTest(dms_lm[,"Mass Shootings"], lags = 2,type="ct")

#  Dickey-Fuller test unit root
summary(ur.df(dms_lm[,"Mass Shootings"], lags = 2, type="trend"))
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# set function
# First differencing function from QMSS package
firstD <- function(var, group, df){
  bad <- (missing(group) & !missing(df))
  if (bad) stop("if df is specified then group must also be specified")
  
  fD <- function(j){ c(NA, diff(j)) }
  
  var.is.alone <- missing(group) & missing(df)
  
  if (var.is.alone) {
    return(fD(var))
    }
  if (missing(df)){
    V <- var
    G <- group }
  else{
    V <- df[, deparse(substitute(var))]
    G <- df[, deparse(substitute(group))]
  }
  
  G <- list(G)
  D.var <- by(V, G, fD)
  unlist(D.var)
  }
```

### Section 3  
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# set df
# get first differences for vars
dms_lm_FD <- dms_lm %>%
  summarise(Year = Year,
            `Single Act FD` = firstD(dms_lm[,"Single Act"]),
            `Multiple Acts FD` = firstD(dms_lm[,"Multiple Acts"]),
            `Single Act w/G FD` = firstD(dms_lm[,"Single Act w/G"]),
            `Multiple Acts w/G FD` = firstD(dms_lm[,"Multiple Acts w/G"]),
            `Mass Shootings FD` = firstD(dms_lm[,"Mass Shootings"]),
            `Fatalities FD` = firstD(dms_lm[,"Fatalities"]),
            `Injuries FD` = firstD(dms_lm[,"Injuries"]),
            `Fatalities/Shootings FD` = firstD(dms_lm[,"Fatalities/Shootings"]),
            `Injuries/Shootings FD` = firstD(dms_lm[,"Injuries/Shootings"]),
            `GDP in Billions FD` = firstD(dms_lm[,"GDP in Billions"]),
            `FA Weapons Ban FD` = firstD(dms_lm[,"FA Weapons Ban"]),
            `Mental Health Issues FD` = firstD(dms_lm[,"Mental Health Issues"]),
            `Major US Military Involvement FD` = firstD(dms_lm[,"Major US Military Involvement"]))

# merge by "Year"
dms_lm_Total <- merge(dms_lm,dms_lm_FD, by = "Year") 

# convert to ts objects
dms_lm_TFD.ts <- ts(dms_lm_Total)
```


### Multiple Modelings with at least one incident with GUN
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Mass Shootings First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_model <- lm(`Mass Shootings FD` ~ `Multiple Acts w/G FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrl1 <- lm(`Mass Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrl2 <- lm(`Mass Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrl3 <- lm(`Mass Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrl4 <- lm(`Mass Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + 
                    `Major US Military Involvement FD`+ `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
summary(dms_model)
summary(dms_cntrl1)
summary(dms_cntrl2)
summary(dms_cntrl3)
summary(dms_cntrl4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_model,dms_cntrl1,dms_cntrl2,dms_cntrl3,dms_cntrl4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Fatalities First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelF <- lm(`Fatalities FD` ~ `Multiple Acts w/G FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlF1 <- lm(`Fatalities FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlF2 <- lm(`Fatalities FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlF3 <- lm(`Fatalities FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrlF4 <- lm(`Fatalities FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`+ 
                    `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelF)
summary(dms_cntrlF1)
summary(dms_cntrlF2)
summary(dms_cntrlF3)
summary(dms_cntrlF4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelF,dms_cntrlF1,dms_cntrlF2,dms_cntrlF3,dms_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Injuries First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelI <- lm(`Injuries FD` ~ `Multiple Acts w/G FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlI1 <- lm(`Injuries FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlI2 <- lm(`Injuries FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlI3 <- lm(`Injuries FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)

dms_cntrlI4 <- lm(`Injuries FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                    `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelI)
summary(dms_cntrlI1)
summary(dms_cntrlI2)
summary(dms_cntrlI3)
summary(dms_cntrlI4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelI,dms_cntrlI1,dms_cntrlI2,dms_cntrlI3,dms_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Fatalities First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelF <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts w/G FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlF1 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlF2 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlF3 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrlF4 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                    `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelF)
summary(dms_cntrlF1)
summary(dms_cntrlF2)
summary(dms_cntrlF3)
summary(dms_cntrlF4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelF,dms_cntrlF1,dms_cntrlF2,dms_cntrlF3,dms_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Injuries First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelI <- lm(`Injuries/Shootings FD` ~ `Multiple Acts w/G FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlI1 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlI2 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` , data = dms_lm_Total)

dms_cntrlI3 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)

dms_cntrlI4 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                    `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelI)
summary(dms_cntrlI1)
summary(dms_cntrlI2)
summary(dms_cntrlI3)
summary(dms_cntrlI4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelI,dms_cntrlI1,dms_cntrlI2,dms_cntrlI3,dms_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```


### Multiple Modeling incidents NO GUN
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Mass Shootings First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_model <- lm(`Mass Shootings FD` ~ `Multiple Acts FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrl1 <- lm(`Mass Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrl2 <- lm(`Mass Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` , data = dms_lm_Total)

dms_cntrl3 <- lm(`Mass Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrl4 <- lm(`Mass Shootings FD` ~ `Multiple Acts FD` + Year  + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_model)
summary(dms_cntrl1)
summary(dms_cntrl2)
summary(dms_cntrl3)
summary(dms_cntrl4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_model,dms_cntrl1,dms_cntrl2,dms_cntrl3,dms_cntrl4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Fatalities First Differncing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelF <- lm(`Fatalities FD` ~ `Multiple Acts FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlF1 <- lm(`Fatalities FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlF2 <- lm(`Fatalities FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlF3 <- lm(`Fatalities FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrlF4 <- lm(`Fatalities FD` ~ `Multiple Acts FD` + Year  + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                    `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelF)
summary(dms_cntrlF1)
summary(dms_cntrlF2)
summary(dms_cntrlF3)
summary(dms_cntrlF4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelF,dms_cntrlF1,dms_cntrlF2,dms_cntrlF3,dms_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Injuries First Differncing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelI <- lm(`Injuries FD` ~ `Multiple Acts FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlI1 <- lm(`Injuries FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlI2 <- lm(`Injuries FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlI3 <- lm(`Injuries FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)

dms_cntrlI4 <- lm(`Injuries FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                    `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelI)
summary(dms_cntrlI1)
summary(dms_cntrlI2)
summary(dms_cntrlI3)
summary(dms_cntrlI4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelI,dms_cntrlI1,dms_cntrlI2,dms_cntrlI3,dms_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Fatalities First Differncing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelF <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlF1 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlF2 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlF3 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrlF4 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                    `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelF)
summary(dms_cntrlF1)
summary(dms_cntrlF2)
summary(dms_cntrlF3)
summary(dms_cntrlF4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelF,dms_cntrlF1,dms_cntrlF2,dms_cntrlF3,dms_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Injuries First Differncing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelI <- lm(`Injuries/Shootings FD` ~ `Multiple Acts FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlI1 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlI2 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlI3 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)

dms_cntrlI4 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                    `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelI)
summary(dms_cntrlI1)
summary(dms_cntrlI2)
summary(dms_cntrlI3)
summary(dms_cntrlI4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelI,dms_cntrlI1,dms_cntrlI2,dms_cntrlI3,dms_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```

### Single Modeling incident with GUN
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Mass Shootings First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_model <- lm(`Mass Shootings FD` ~ `Single Act w/G FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrl1 <- lm(`Mass Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrl2 <- lm(`Mass Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrl3 <- lm(`Mass Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrl4 <- lm(`Mass Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_model)
summary(dms_cntrl1)
summary(dms_cntrl2)
summary(dms_cntrl3)
summary(dms_cntrl4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_model,dms_cntrl1,dms_cntrl2,dms_cntrl3,dms_cntrl4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Fatalities First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelF <- lm(`Fatalities FD` ~ `Single Act w/G FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlF1 <- lm(`Fatalities FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlF2 <- lm(`Fatalities FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlF3 <- lm(`Fatalities FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrlF4 <- lm(`Fatalities FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelF)
summary(dms_cntrlF1)
summary(dms_cntrlF2)
summary(dms_cntrlF3)
summary(dms_cntrlF4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelF,dms_cntrlF1,dms_cntrlF2,dms_cntrlF3,dms_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Injuries First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelI <- lm(`Injuries FD` ~ `Single Act w/G FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlI1 <- lm(`Injuries FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlI2 <- lm(`Injuries FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` , data = dms_lm_Total)

dms_cntrlI3 <- lm(`Injuries FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)

dms_cntrlI4 <- lm(`Injuries FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelI)
summary(dms_cntrlI1)
summary(dms_cntrlI2)
summary(dms_cntrlI3)
summary(dms_cntrlI4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelI,dms_cntrlI1,dms_cntrlI2,dms_cntrlI3,dms_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Fatalities First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelF <- lm(`Fatalities/Shootings FD` ~ `Single Act w/G FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlF1 <- lm(`Fatalities/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlF2 <- lm(`Fatalities/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlF3 <- lm(`Fatalities/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrlF4 <- lm(`Fatalities/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelF)
summary(dms_cntrlF1)
summary(dms_cntrlF2)
summary(dms_cntrlF3)
summary(dms_cntrlF4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelF,dms_cntrlF1,dms_cntrlF2,dms_cntrlF3,dms_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Injuries First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelI <- lm(`Injuries/Shootings FD` ~ `Single Act w/G FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlI1 <- lm(`Injuries/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlI2 <- lm(`Injuries/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` , data = dms_lm_Total)

dms_cntrlI3 <- lm(`Injuries/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)

dms_cntrlI4 <- lm(`Injuries/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelI)
summary(dms_cntrlI1)
summary(dms_cntrlI2)
summary(dms_cntrlI3)
summary(dms_cntrlI4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelI,dms_cntrlI1,dms_cntrlI2,dms_cntrlI3,dms_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```


### Single Modeling incident NO GUN
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Mass Shootings First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_model <- lm(`Mass Shootings FD` ~ `Single Act FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrl1 <- lm(`Mass Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrl2 <- lm(`Mass Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` , data = dms_lm_Total)

dms_cntrl3 <- lm(`Mass Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrl4 <- lm(`Mass Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_model)
summary(dms_cntrl1)
summary(dms_cntrl2)
summary(dms_cntrl3)
summary(dms_cntrl4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_model,dms_cntrl1,dms_cntrl2,dms_cntrl3,dms_cntrl4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Fatalities First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelF <- lm(`Fatalities FD` ~ `Single Act FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlF1 <- lm(`Fatalities FD` ~ `Single Act FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlF2 <- lm(`Fatalities FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlF3 <- lm(`Fatalities FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrlF4 <- lm(`Fatalities FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelF)
summary(dms_cntrlF1)
summary(dms_cntrlF2)
summary(dms_cntrlF3)
summary(dms_cntrlF4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelF,dms_cntrlF1,dms_cntrlF2,dms_cntrlF3,dms_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Injuries First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelI <- lm(`Injuries FD` ~ `Single Act FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlI1 <- lm(`Injuries FD` ~ `Single Act FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlI2 <- lm(`Injuries FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlI3 <- lm(`Injuries FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)

dms_cntrlI4 <- lm(`Injuries FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelI)
summary(dms_cntrlI1)
summary(dms_cntrlI2)
summary(dms_cntrlI3)
summary(dms_cntrlI4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelI,dms_cntrlI1,dms_cntrlI2,dms_cntrlI3,dms_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Fatalities First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelF <- lm(`Fatalities/Shootings FD` ~ `Single Act FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlF1 <- lm(`Fatalities/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` , data = dms_lm_Total)
dms_cntrlF2 <- lm(`Fatalities/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlF3 <- lm(`Fatalities/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)
dms_cntrlF4 <- lm(`Fatalities/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelF)
summary(dms_cntrlF1)
summary(dms_cntrlF2)
summary(dms_cntrlF3)
summary(dms_cntrlF4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelF,dms_cntrlF1,dms_cntrlF2,dms_cntrlF3,dms_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS 
# Injuries First Differencing
# LM Regression
# perform a dms naive regression w/ time trend var
dms_modelI <- lm(`Injuries/Shootings FD` ~ `Single Act FD` + Year, data = dms_lm_Total)

# perform some dms multiple regressions
dms_cntrlI1 <- lm(`Injuries/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD`, data = dms_lm_Total)
dms_cntrlI2 <- lm(`Injuries/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = dms_lm_Total)

dms_cntrlI3 <- lm(`Injuries/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = dms_lm_Total)

dms_cntrlI4 <- lm(`Injuries/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` +
                   `Mental Health Issues FD`, data = dms_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(dms_modelI)
summary(dms_cntrlI1)
summary(dms_cntrlI2)
summary(dms_cntrlI3)
summary(dms_cntrlI4)
```

## 
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# DMS
# Model Table
models <- list(dms_modelI,dms_cntrlI1,dms_cntrlI2,dms_cntrlI3,dms_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```


