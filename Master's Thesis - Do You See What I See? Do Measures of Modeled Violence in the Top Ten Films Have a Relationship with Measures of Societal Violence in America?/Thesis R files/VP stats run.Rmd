---
title: "Appendix 3b:" 
subtitle: "The Violence Project (VP) Analysis Results"
output:
  html_document: default
  word_document: default
  pdf_document: default
---

```{r setup, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
## load packages
require(readxl)
require(data.table)
require(tidyverse)
require(dplyr)
require(car)
require(lmtest)
require(sandwich)
require(psych)
require(tseries)
require(fUnitRoots)
require(urca)
require(TSA)
require(forecast)
require(ggplot2)
require(ggthemes)
require(corrplot)
require(sjPlot)
require(gridExtra)
```


```{r , include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# read in data files
# Violence Project 1966-2022
vp <- read_excel("/Data/VP_film_6622_rates.xlsx")
```

### Section 1    
```{r , include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# df set
# vars and correlation
vp_cor <- vp[,c(1,9:12,14:16,20:22,39)]

# rename vars
vp_cor <- vp_cor %>%
  rename(`Single Act` = single_rate,
         `Multiple Acts` = multiple_rate,
         `Single Act w/G` = single_rate_gun,
         `Multiple Acts w/G` = multiple_rate_gun,
         `FA Weapons Ban` = `FAWB (tighten)`,
         `Major US Military Involvement` = `Major military involvement`,
         `Mass Shootings` = incidents_per_yr,
         Fatalities = fatalities_per_yr,
         Injuries = injuries_per_yr)

# aggregate and get means 
vp_cor <- aggregate(subset(vp_cor, sel = -Year), list(year = vp_cor$Year), mean, na.rm=T)
vp_core <- vp_cor %>%
  rename(Year = year) %>%
  mutate(`Fatalities/Shootings` = Fatalities/`Mass Shootings`,
         `Injuries/Shootings` = Injuries/`Mass Shootings`)

# make into ts object
vp_cor_ts <- ts(vp_core)
```

### Descriptive Statistics
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# correlations and visualizations
# descriptives
tab_df(describe(vp_cor_ts),
  title = "Violence Project",
  show.rownames = TRUE)
```

### Correlations
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# create a vp correlation matrix
vp_cor_matrix <- cor(vp_cor_ts, use = "complete.obs")
tab_corr(vp_cor_matrix)
```

### Visualizations

### Correlation Table
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# create a vp correlation plot
corrplot(vp_cor_matrix[c(1:5,9:11,13,14),c(1:5,9:11,13,14)], method = "number",number.cex = 0.75, tl.col = "black", tl.cex = 0.95, tl.offset = 0.2)
```


### Independent and Dependent Variable Time Trends   
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# vp objects for gg plot
# Single Act
vp_single <- vp_core %>%
  group_by(Year,`Single Act`) %>%
  distinct(.keep_all = FALSE) %>%
  summarise()

# Multiple Act
vp_multi <- vp_core %>%
  group_by(Year,`Multiple Acts`) %>%
  distinct(.keep_all = FALSE) %>%
  summarise()

# Single Act w/Gun
vp_single_gun <- vp_core %>%
  group_by(Year,`Single Act w/G`) %>%
  distinct(.keep_all = FALSE) %>%
  summarise()

# Multiple Act w/Gun
vp_multi_gun <- vp_core %>%
  group_by(Year,`Multiple Acts w/G`) %>%
  distinct(.keep_all = FALSE) %>%
  summarise()
```


```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# vp movie ggplots
# Single Act
vp_sing <- ggplot(data = vp_single, aes(x = Year, y = `Single Act`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Rates of Top Ten Movies with a Single Modeled Act \nof Violence Over Time",
       subtitle = "Modeled Act w/o Firearm",
       x = "Year",
       y = "Single Modeled Act of Violence (Rates)") +
  theme_tufte() +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.1)) +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Multiple Act
vp_multi <- ggplot(data = vp_multi, aes(x = Year, y = `Multiple Acts`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Rates of Top Ten Movies with Multiple Modeled Acts \nof Violence Over Time",
       subtitle = "Modeled Acts w/o Firearms",
       x = "Year",
       y = "Multiple Modeled Acts of Violence (Rates)") +
  theme_tufte() +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.1)) +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Single Act w/Gun
vp_sing_gun <- ggplot(data = vp_single_gun, aes(x = Year, y = `Single Act w/G`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Rates of Top Ten Movies with a Single Modeled Act \nof Violence Over Time",
       subtitle = "Modeled Act w/ Firearm",
       x = "Year",
       y = "Single Modeled Acts of Violence (Rates)") +
  theme_tufte() +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.1)) +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Multiple Act w/Gun
vp_multi_gun <- ggplot(data = vp_multi_gun, aes(x = Year, y = `Multiple Acts w/G`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Rates of Top Ten Movies with Multiple Modeled Acts \nof Violence Over Time",
       subtitle = "Modeled Acts w/ At Least One Firearm Instance",
       x = "Year",
       y = "Multiple Modeled Acts of Violence (Rates)") +
  theme_tufte() +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.1)) +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# vp Mass Shootings ggplots
# Mass Shootings
vp_incidents_per_yr <- ggplot(data = vp_core, aes(x = Year, y = `Mass Shootings`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Mass Shootings Over Time",
       x = "Year",
       y = "Number of Mass Shootings") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# fatalities during Mass Shootings
vp_fatalities_per_yr <- ggplot(data = vp_core, aes(x = Year, y = Fatalities)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Fatalities During Mass Shootings Over Time",
       x = "Year",
       y = "Number of Fatalities During Mass Shootings") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

#injuries during Mass Shootings
vp_injuries_per_yr <- ggplot(data = vp_core, aes(x = Year, y = Injuries)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Injuries During Mass Shootings Over Time",
       x = "Year",
       y = "Number of Injuries During Mass Shootings") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Average fatalities per Mass Shootings
vp_fatalities_per_ms <- ggplot(data = vp_core, aes(x = Year, y = Fatalities/`Mass Shootings`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Average Fatalities per Mass Shooting Over Time",
       x = "Year",
       y = "Average Fatalities per Mass Shooting") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Average injuries per Mass Shootings
vp_injuries_per_ms <- ggplot(data = vp_core, aes(x = Year, y = Injuries/`Mass Shootings`)) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Average Injuries per Mass Shooting Over Time",
       x = "Year",
       y = "Average Injuries per Mass Shooting") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))
```


```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# vp gun violence LOG ggplots
# Mass Shootings (LOG)
vp_incidents_per_yr_log <- ggplot(data = vp_core, aes(x = Year, y = log(`Mass Shootings`))) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Mass Shootings Over Time (LOG)",
       x = "Year",
       y = "Number of Mass Shootings (LOG)") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# fatalities during Mass Shootings (LOG)
vp_fatalities_per_yr_log <- ggplot(data = vp_core, aes(x = Year, y = log(Fatalities))) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Fatalities During Mass Shootings Over Time (LOG)",
       x = "Year",
       y = "Number of Fatalities During Mass Shootings (LOG)") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

#injuries during Mass Shootings (LOG)
vp_injuries_per_yr_log <- ggplot(data = vp_core, aes(x = Year, y = log(Injuries))) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Injuries During Mass Shootings Over Time (LOG)",
       x = "Year",
       y = "Number of Injuries During Mass Shootings (LOG)") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Average fatalities per Mass Shootings LOG
vp_fatalities_per_ms_log <- ggplot(data = vp_core, aes(x = Year, y = log(Fatalities/`Mass Shootings`))) +
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Average Fatalities per Mass Shooting Over Time (LOG)",
       x = "Year",
       y = "Average Fatalities per Mass Shooting (LOG)") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))

# Average injuries per Mass Shootings LOG
vp_injuries_per_ms_log <- ggplot(data = vp_core, aes(x = Year, y = log(Injuries/`Mass Shootings`)))+
  geom_line(color = "black", size = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 0.7) +
  labs(title = "Average Injuries per Mass Shooting Over Time (LOG)",
       x = "Year",
       y = "Average Injuries per Mass Shooting (LOG)") +
  theme_tufte() +
  # Add dotted lines to mark the start and end of weapons ban
  geom_vline(xintercept = 1994, linetype = "dotted", color = "grey", size = 0.7) +
  geom_vline(xintercept = 2004, linetype = "dotted", color = "grey", size = 0.7) +
  annotate("text", x = 1999, y = 0.07,color = "black", label = "Firearm Weapons Ban", size = 1.8) +
  theme(text = element_text(size = 8),
  axis.text = element_text(size = 7),
  axis.title = element_text(size = 7),
  legend.title = element_text(size = 8))
```

##   
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# visualization of ggplots (call gg objects)
# vp movie rates plots
# vp_sing
# vp_multi
# vp_sing_gun
# vp_multi_gun

grid.arrange(vp_sing,vp_multi,vp_sing_gun,vp_multi_gun)
```

##  
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# vp yearly violence counts plots
# vp_incidents_per_yr
# vp_fatalities_per_yr
# vp_injuries_per_yr
# vp_fatalities_per_ms
# vp_injuries_per_ms

grid.arrange(vp_incidents_per_yr,vp_fatalities_per_yr,vp_injuries_per_yr, ncol = 2)
grid.arrange(vp_fatalities_per_ms,vp_injuries_per_ms, ncol = 2)

# vp yearly violence counts LOG plots
# vp_incidents_per_yr_log
# vp_fatalities_per_yr_log
# vp_injuries_per_yr_log
# vp_fatalities_per_ms_log
# vp_injuries_per_ms_log

grid.arrange(vp_incidents_per_yr_log,vp_fatalities_per_yr_log,vp_injuries_per_yr_log, ncol = 2)
grid.arrange(vp_fatalities_per_ms_log,vp_injuries_per_ms_log, ncol = 2)
```

### Section 2  
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
```

### Test First regression for AR and UR  
Base linear model with prime variables of interest:    
*Multiple Acts w/G* (IV) and *Mass Shootings* (DV)  
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# new df for lm
vp_lm <- vp_core
vp_lm.ts <- ts(vp_lm)

# LM Regression
# perform a vp naive regression w/ time trend var
vp_model <- lm(`Mass Shootings` ~ `Multiple Acts w/G` + Year, data = vp_lm)

# print the summary of the model
tab_model(vp_model)

```

### Test for autocorrelation in the errors   
em = residuals from the base linear model  
Lag <= 3   
Seems no AR is present.   

```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# check for AR 
# residuals
em <- vp_model$resid
#min(em)
#max(em)
acf(em,xlim =c(0,5), col = "red", lwd =2)
pacf(em,xlim =c(0,5), col = "red", lwd =2)
plot(em)

# durbin-watson test auto* correlation 
dwt(vp_model, max.lag = 3)
durbinWatsonTest(vp_model, max.lag=3)

# breusch-Godfrey test serial* correlation seems NO AR PRESENT
bgtest(vp_model)
```

### Test for unit roots  
Seems UR is not present  
Adding drift or trend (p < 0.05)  
```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
##### CHECK FOR UNIT ROOTS #### seems like there is no UR
# Dickey-Fuller
# augmented Dickey-Fuller test
adfTest(vp_lm.ts[,"Mass Shootings"], lags = 3)
# augmented Dickey-Fuller w/ DRIFT
adfTest(vp_lm.ts[,"Mass Shootings"], lags = 3,type="c")
# augmented Dickey-Fuller w/ TREND
adfTest(vp_lm.ts[,"Mass Shootings"], lags = 3,type="ct")

#  Dickey-Fuller test unit root
summary(ur.df(vp_lm.ts[,"Mass Shootings"], lags = 3, type="trend"))
```


```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# function set
# First differencing function from QMSS package
firstD <- function(var, group, df){
  bad <- (missing(group) & !missing(df))
  if (bad) stop("if df is specified then group must also be specified")

  fD <- function(j){ c(NA, diff(j)) }

  var.is.alone <- missing(group) & missing(df)

  if (var.is.alone) {
    return(fD(var))
    }
  if (missing(df)){
    V <- var
    G <- group }
  else{
    V <- df[, deparse(substitute(var))]
    G <- df[, deparse(substitute(group))]
  }

  G <- list(G)
  D.var <- by(V, G, fD)
  unlist(D.var)
  }
```
### Section 3
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# df set
# get first differences for vars
vp_lm_FD <- vp_lm %>%
  summarise(Year = Year,
            `Single Act FD` = firstD(vp_lm[,"Single Act"]),
            `Multiple Acts FD` = firstD(vp_lm[,"Multiple Acts"]),
            `Single Act w/G FD` = firstD(vp_lm[,"Single Act w/G"]),
            `Multiple Acts w/G FD` = firstD(vp_lm[,"Multiple Acts w/G"]),
            `Mass Shootings FD` = firstD(vp_lm[,"Mass Shootings"]),
            `Fatalities FD` = firstD(vp_lm[,"Fatalities"]),
            `Injuries FD` = firstD(vp_lm[,"Injuries"]),
            `Fatalities/Shootings FD` = firstD(vp_lm[,"Fatalities"]/ vp_lm[,"Mass Shootings"]),
            `Injuries/Shootings FD` = firstD(vp_lm[,"Injuries"]/ vp_lm[,"Mass Shootings"]),
            `Health/Mental Health FD` = firstD(vp_lm[,"Health/Mental Health Issues"]),
            `GDP in Billions FD` = firstD(vp_lm[,"GDP in Billions"]),
            `FA Weapons Ban FD` = firstD(vp_lm[,"FA Weapons Ban"]),
            `Major US Military Involvement FD` = firstD(vp_lm[,"Major US Military Involvement"]))

# merge by "Year"
vp_lm_Total <- merge(vp_lm,vp_lm_FD, by = "Year")

# convert to ts objects
vp_lm_TFD.ts <- ts(vp_lm_Total)
```


### Multiple Modelings with at least one incident with GUN
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Mass Shootings First Differncing
# LM Regression
# perform a vp multi naive regression w/ time trend var
vp_model <- lm(`Mass Shootings FD` ~ `Multiple Acts w/G FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrl1 <- lm(`Mass Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrl2 <- lm(`Mass Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrl3 <- lm(`Mass Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrl4 <- lm(`Mass Shootings FD` ~ `Multiple Acts w/G FD` + Year  + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_model)
summary(vp_cntrl1)
summary(vp_cntrl2)
summary(vp_cntrl3)
summary(vp_cntrl4)
```

##  
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_model,vp_cntrl1,vp_cntrl2,vp_cntrl3,vp_cntrl4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Fatalities First Differncing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelF <- lm(`Fatalities FD` ~ `Multiple Acts w/G FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlF1 <- lm(`Fatalities FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlF2 <- lm(`Fatalities FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlF3 <- lm(`Fatalities FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrlF4 <- lm(`Fatalities FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelF)
summary(vp_cntrlF1)
summary(vp_cntrlF2)
summary(vp_cntrlF3)
summary(vp_cntrlF4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelF,vp_cntrlF1,vp_cntrlF2,vp_cntrlF3,vp_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Injuries First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelI <- lm(`Injuries FD` ~ `Multiple Acts w/G FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlI1 <- lm(`Injuries FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlI2 <- lm(`Injuries FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` , data = vp_lm_Total)

vp_cntrlI3 <- lm(`Injuries FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)

vp_cntrlI4 <- lm(`Injuries FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelI)
summary(vp_cntrlI1)
summary(vp_cntrlI2)
summary(vp_cntrlI3)
summary(vp_cntrlI4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelI,vp_cntrlI1,vp_cntrlI2,vp_cntrlI3,vp_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Fatalities/Shootings First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelF <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts w/G FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlF1 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` , data = vp_lm_Total)
vp_cntrlF2 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlF3 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                 data = vp_lm_Total)
vp_cntrlF4 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelF)
summary(vp_cntrlF1)
summary(vp_cntrlF2)
summary(vp_cntrlF3)
summary(vp_cntrlF4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelF,vp_cntrlF1,vp_cntrlF2,vp_cntrlF3,vp_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Injuries/Shootings First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelI <- lm(`Injuries/Shootings FD` ~ `Multiple Acts w/G FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlI1 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlI2 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlI3 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` , 
                 data = vp_lm_Total)

vp_cntrlI4 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelI)
summary(vp_cntrlI1)
summary(vp_cntrlI2)
summary(vp_cntrlI3)
summary(vp_cntrlI4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelI,vp_cntrlI1,vp_cntrlI2,vp_cntrlI3,vp_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```


### Multiple Modeling incidents NO GUN
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Mass Shootings First Differencing
# LM Regression
# perform a vp_multi naive regression w/ time trend var
vp_model <- lm(`Mass Shootings FD` ~ `Multiple Acts FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrl1 <- lm(`Mass Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrl2 <- lm(`Mass Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` , data = vp_lm_Total)

vp_cntrl3 <- lm(`Mass Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrl4 <- lm(`Mass Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_model)
summary(vp_cntrl1)
summary(vp_cntrl2)
summary(vp_cntrl3)
summary(vp_cntrl4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_model,vp_cntrl1,vp_cntrl2,vp_cntrl3,vp_cntrl4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Fatalities First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelF <- lm(`Fatalities FD` ~ `Multiple Acts FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlF1 <- lm(`Fatalities FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlF2 <- lm(`Fatalities FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlF3 <- lm(`Fatalities FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrlF4 <- lm(`Fatalities FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelF)
summary(vp_cntrlF1)
summary(vp_cntrlF2)
summary(vp_cntrlF3)
summary(vp_cntrlF4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelF,vp_cntrlF1,vp_cntrlF2,vp_cntrlF3,vp_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Injuries First Differencing
# LM Regression
# perform a vp naive regression w/ time trend
vp_modelI <- lm(`Injuries FD` ~ `Multiple Acts FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlI1 <- lm(`Injuries FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlI2 <- lm(`Injuries FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` , data = vp_lm_Total)

vp_cntrlI3 <- lm(`Injuries FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)

vp_cntrlI4 <- lm(`Injuries FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelI)
summary(vp_cntrlI1)
summary(vp_cntrlI2)
summary(vp_cntrlI3)
summary(vp_cntrlI4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelI,vp_cntrlI1,vp_cntrlI2,vp_cntrlI3,vp_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Fatalities/Shootings
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelF <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlF1 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlF2 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlF3 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrlF4 <- lm(`Fatalities/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelF)
summary(vp_cntrlF1)
summary(vp_cntrlF2)
summary(vp_cntrlF3)
summary(vp_cntrlF4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelF,vp_cntrlF1,vp_cntrlF2,vp_cntrlF3,vp_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Injuries/Shootings First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelI <- lm(`Injuries/Shootings FD` ~ `Multiple Acts FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlI1 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` , data = vp_lm_Total)
vp_cntrlI2 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlI3 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)

vp_cntrlI4 <- lm(`Injuries/Shootings FD` ~ `Multiple Acts FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelI)
summary(vp_cntrlI1)
summary(vp_cntrlI2)
summary(vp_cntrlI3)
summary(vp_cntrlI4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelI,vp_cntrlI1,vp_cntrlI2,vp_cntrlI3,vp_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```


### Single Modeling incident with GUN
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Mass Shootings First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_model <- lm(`Mass Shootings FD` ~ `Single Act w/G FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrl1 <- lm(`Mass Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrl2 <- lm(`Mass Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrl3 <- lm(`Mass Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrl4 <- lm(`Mass Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_model)
summary(vp_cntrl1)
summary(vp_cntrl2)
summary(vp_cntrl3)
summary(vp_cntrl4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_model,vp_cntrl1,vp_cntrl2,vp_cntrl3,vp_cntrl4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Fatalities First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelF <- lm(`Fatalities FD` ~ `Single Act w/G FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlF1 <- lm(`Fatalities FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlF2 <- lm(`Fatalities FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlF3 <- lm(`Fatalities FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrlF4 <- lm(`Fatalities FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelF)
summary(vp_cntrlF1)
summary(vp_cntrlF2)
summary(vp_cntrlF3)
summary(vp_cntrlF4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelF,vp_cntrlF1,vp_cntrlF2,vp_cntrlF3,vp_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Injuries First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelI <- lm(`Injuries FD` ~ `Single Act w/G FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlI1 <- lm(`Injuries FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlI2 <- lm(`Injuries FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlI3 <- lm(`Injuries FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)

vp_cntrlI4 <- lm(`Injuries FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelI)
summary(vp_cntrlI1)
summary(vp_cntrlI2)
summary(vp_cntrlI3)
summary(vp_cntrlI4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelI,vp_cntrlI1,vp_cntrlI2,vp_cntrlI3,vp_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Fatalities/Shootings First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelF <- lm(`Fatalities/Shootings FD` ~ `Single Act w/G FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlF1 <- lm(`Fatalities/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlF2 <- lm(`Fatalities/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlF3 <- lm(`Fatalities/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrlF4 <- lm(`Fatalities/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelF)
summary(vp_cntrlF1)
summary(vp_cntrlF2)
summary(vp_cntrlF3)
summary(vp_cntrlF4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelF,vp_cntrlF1,vp_cntrlF2,vp_cntrlF3,vp_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Injuries/Shootings
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelI <- lm(`Injuries/Shootings FD` ~ `Single Act w/G FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlI1 <- lm(`Injuries/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlI2 <- lm(`Injuries/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` , data = vp_lm_Total)

vp_cntrlI3 <- lm(`Injuries/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)

vp_cntrlI4 <- lm(`Injuries/Shootings FD` ~ `Single Act w/G FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelI)
summary(vp_cntrlI1)
summary(vp_cntrlI2)
summary(vp_cntrlI3)
summary(vp_cntrlI4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelI,vp_cntrlI1,vp_cntrlI2,vp_cntrlI3,vp_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```


### Single Modeling incident NO GUN
```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Mass Shootings First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_model <- lm(`Mass Shootings FD` ~ `Single Act FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrl1 <- lm(`Mass Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrl2 <- lm(`Mass Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrl3 <- lm(`Mass Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrl4 <- lm(`Mass Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_model)
summary(vp_cntrl1)
summary(vp_cntrl2)
summary(vp_cntrl3)
summary(vp_cntrl4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_model,vp_cntrl1,vp_cntrl2,vp_cntrl3,vp_cntrl4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Fatalities First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelF <- lm(`Fatalities FD` ~ `Single Act FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlF1 <- lm(`Fatalities FD` ~ `Single Act FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlF2 <- lm(`Fatalities FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlF3 <- lm(`Fatalities FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrlF4 <- lm(`Fatalities FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```


```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelF)
summary(vp_cntrlF1)
summary(vp_cntrlF2)
summary(vp_cntrlF3)
summary(vp_cntrlF4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelF,vp_cntrlF1,vp_cntrlF2,vp_cntrlF3,vp_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Injuries First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelI <- lm(`Injuries FD` ~ `Single Act FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlI1 <- lm(`Injuries FD` ~ `Single Act FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlI2 <- lm(`Injuries FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlI3 <- lm(`Injuries FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)

vp_cntrlI4 <- lm(`Injuries FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelI)
summary(vp_cntrlI1)
summary(vp_cntrlI2)
summary(vp_cntrlI3)
summary(vp_cntrlI4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelI,vp_cntrlI1,vp_cntrlI2,vp_cntrlI3,vp_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Fatalities/Shootings First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelF <- lm(`Fatalities/Shootings FD` ~ `Single Act FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlF1 <- lm(`Fatalities/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlF2 <- lm(`Fatalities/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlF3 <- lm(`Fatalities/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)
vp_cntrlF4 <- lm(`Fatalities/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelF)
summary(vp_cntrlF1)
summary(vp_cntrlF2)
summary(vp_cntrlF3)
summary(vp_cntrlF4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelF,vp_cntrlF1,vp_cntrlF2,vp_cntrlF3,vp_cntrlF4)
       
tab_model(models,show.ci = FALSE)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Injuries/Shootings First Differencing
# LM Regression
# perform a vp naive regression w/ time trend var
vp_modelI <- lm(`Injuries/Shootings FD` ~ `Single Act FD` + Year, data = vp_lm_Total)

# perform some vp multiple regressions
vp_cntrlI1 <- lm(`Injuries/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD`, data = vp_lm_Total)
vp_cntrlI2 <- lm(`Injuries/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD`, data = vp_lm_Total)

vp_cntrlI3 <- lm(`Injuries/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD`, 
                  data = vp_lm_Total)

vp_cntrlI4 <- lm(`Injuries/Shootings FD` ~ `Single Act FD` + Year + `GDP in Billions FD` + `FA Weapons Ban FD` + `Major US Military Involvement FD` + 
                  `Health/Mental Health FD`, data = vp_lm_Total)
```

```{r, include = FALSE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# print the summary of the models
summary(vp_modelI)
summary(vp_cntrlI1)
summary(vp_cntrlI2)
summary(vp_cntrlI3)
summary(vp_cntrlI4)
```

##   
```{r, include = TRUE, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
# VP
# Model Table
models <- list(vp_modelI,vp_cntrlI1,vp_cntrlI2,vp_cntrlI3,vp_cntrlI4)
       
tab_model(models,show.ci = FALSE)
```
